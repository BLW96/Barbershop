<% layout('layouts/boilerplate') %>
    <section class="shop-section">
        <div class="page-padding">
            <div class="container-large">
                <div class="padding-vertical padding-custom">
                    <div class="shop-component">
                        <div class="shop-text-wrapper">
                            <div class="styled-subheading-wrapper">
                                <div class="styled-subheading-line"></div>
                                <div class="styled-subheading">Shop All</div>
                                <div class="styled-subheading-line"></div>
                            </div>
                        </div>
                        <div class="dropdown products-dropdown-filter">
                            <button class="btn btn-outline-light dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                                Sort by:&nbsp; Categories
                            </button>
                            <ul class="dropdown-menu">
                                <% categories.forEach(function(c) {%>
                                    <li><a class="dropdown-item" href="/products/cate/<%= c.slug %>">
                                            <%= c.title%>
                                        </a></li>
                                    <% }) %>
                            </ul>
                        </div>

                        <div class="shop-products-wrapper">
                            <div class="products-list">
                                <% for(let product of products) {%>
                                    <div class="list-item">
                                        <a href="/products/<%= product.category %>/<%= product.slug %>" class="product-col-item-wrapper">
                                            <div class="product-top-img-wrapper">
                                                <img src="../../product_images/<%= product.id %>/<%= product.image %> " alt="" class="shop-product-img">
                                            </div>
                                            <div class="product-bottom-wrapper">
                                                <div class="shop-product-item-price">
                                                    &euro;<%= parseFloat(product.price).toFixed(2) %>
                                                </div>
                                                <div class="shop-product-item-title">
                                                    <%= product.title %>
                                                </div>
                                                <div class="shop-product-item-desc">
                                                    <%= product.desc %>
                                                </div>
                                            </div>
                                        </a>
                                        <a href="/cart/add/<%= product.slug %>" class="add-cart-btn">Quick Add</a>
                                    </div>
                                    <%}%>
                            </div>
                            <br>
                            <br>
                            <div class="pagination-links d-flex justify-content-center">

                                <% if (pages> 0) { %>
                                    <ul class="pagination text-center text-white">
                                        <% if (current==1) { %>
                                            <li class="page-item disabled"><a class="page-link">First</a></li>
                                            <% } else { %>
                                                <li class="page-item"><a class="page-link" href="/products/1">First</a></li>
                                                <% } %>
                                                    <% var i=(Number(current)> 5 ? Number(current) - 4 : 1) %>
                                                        <% if (i !==1) { %>
                                                            <li class="disabled"><a>...</a></li>
                                                            <% } %>
                                                                <% for (; i <=(Number(current) + 4) && i <=pages; i++) { %>
                                                                    <% if (i==current) { %>
                                                                        <li class="page-item active"><a class="page-link">
                                                                                <%= i %>
                                                                            </a></li>
                                                                        <% } else { %>
                                                                            <li class="page-item"><a class="page-link" href="/products/<%= i %>">
                                                                                    <%= i %>
                                                                                </a></li>
                                                                            <% } %>
                                                                                <% if (i==Number(current) + 4 && i < pages) { %>
                                                                                    <li class="disabled"><a>...</a></li>
                                                                                    <% } %>
                                                                                        <% } %>
                                                                                            <% if (current==pages) { %>
                                                                                                <li class="page-item disabled"><a class="page-link">Last</a></li>
                                                                                                <% } else { %>
                                                                                                    <li class="page-item"><a class="page-link" href="/products/<%= pages %>">Last</a></li>
                                                                                                    <% } %>
                                    </ul>
                                    <% } %>
                            </div>
                        </div>


                    </div>
                </div>
            </div>
        </div>
    </section>