<% layout('layouts/adminBoilerplate') %>

    <h1 class="text-center">Add a product</h1>
    <a href="/admin/products" class="btn btn-secondary">&#171; Back to all products</a>
    <br>
    <br>

    <form action="/admin/products/add-product" method="POST" novalidate class="validated-form" enctype="multipart/form-data">
        <div class="row">
            <div class="col-8 offset-1">
                <div class="mb-3">
                    <div class="input-group">
                        <label for="title" class="form-label me-2">Title</label>
                        <input type="text" class="form-control" name="title" placeholder="Title" required>
                    </div>
                </div>

                <div class="mb-3">
                    <div class="input-group">
                        <label for="brand" class="form-label me-2">Brand</label>
                        <input type="text" class="form-control" name="brand" placeholder="brand" required>
                    </div>
                </div>

                <div class="mb-3">
                    <div class="input-group">
                        <label for="desc" class="form-label me-2">Description</label>
                        <textarea type="text" class="form-control" name="desc" row="10" cols="30" placeholder="Description" required></textarea>
                    </div>
                </div>
                <div class="mb-3">
                    <div class="input-group">
                        <label for="ingredients" class="form-label me-2">Ingredients</label>
                        <textarea type="text" class="form-control" name="ingredients" row="10" cols="30" placeholder="ingredients" required></textarea>
                    </div>
                </div>

                <div class="mb-3">
                    <div class="input-group">
                        <label for="details" class="form-label me-2">Details</label>
                        <textarea type="text" class="form-control" name="details" row="10" cols="30" placeholder="details" required></textarea>
                    </div>
                </div>

                <div class="mb-3">
                    <div class="input-group">
                        <label for="price" class="form-label me-2">price</label>
                        <input type="number" class="form-control" name="price" placeholder="price" required>
                    </div>
                </div>

                <div class="mb-3">
                    <div class="input-group">
                        <label for="stock" class="form-label me-2">stock</label>
                        <input type="number" class="form-control" name="stock" placeholder="stock" required>
                    </div>
                </div>


                <div class="mb-3">
                    <div class="input-group">
                        <label for="category" class="form-label me-2">Category</label>
                        <select name="category">
                            <% categories.forEach(function(cat) { %>
                                <option value="<%= cat.slug %>">
                                    <%= cat.title %>
                                </option>
                                <% }) %>
                        </select>
                    </div>
                </div>


                <div class="mb-3">
                    <div class="input-group">
                        <label for="image" class="form-label me-2">Image</label>
                        <input type="file" class="form-control" name="image" id="img" required>
                    </div>
                    <img src="#" id="imgPreview" alt="" class="mt-3">
                </div>
                <button class="btn btn-success mt-2">Submit</button>
            </div>
        </div>
    </form>

    <script>
        function readURL(input) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();

                reader.onload = function (e) {
                    $("#imgPreview").attr('src', e.target.result).width(100).height(100);
                }
                reader.readAsDataURL(input.files[0]);
            }
        }

        $('#img').change(function () {
            readURL(this);
        })
    </script>